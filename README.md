# Virtual Roulette

Your task is to write a backend service for a virtual roulette game. This Backend application should provide following services: 

## Sign In service
User must be able to sign in with username and password.

## User Balance
Method to request user’s balance. Balance must be provided in US dollar cents. 

## Make Bet
Method to make bets from client application. User’s bet (selected numbers and bet amount) will be submitted from the client app as a JSON string. After receiving bet from client, bet string must be analysed whether it is correct or not, which can be done by provided “RouletteBetAnalyzer” library.

Import the library: `ge.singular.roulette.dll`

2nd step:

```csharp
//bet string received from the client 
string bet = "[{\"T\": \"v\", \"I\": 20, \"C\": 1, \"K\": 1}]"; 

//check bet string’s validity 
IsBetValidResponse ibvr = CheckBets.IsValid(bet); 

//as a response you will receive whether bet string is correct or not, and bet amount made by user (in cents). 
Console.WriteLine("Is bet valid: " + ibvr.getIsValid() + " bet amount in cents is: " + ibvr.getBetAmount()); 
```

After validation user’s bet string and bet amount must be stored in the database(for simplicity you can use memory cache). Next, by using secure random you should generate winning number (from 0 to 36). Then you should check whether user has won something or not, which again could be done by provided library: 

```csharp
//winning number, generated by secure random
int winnum = 12; 
//by calling EstimateWin method from CheckBets class you can determine if user won something.
int estWin = CheckBets.EstimateWin(bet, winnum);
// if estWin is equal to 0 this means that user lost. 
Console.WriteLine("User won: " + estWin + " cents."); 
```

And finally save winning number and user’s won amount in database(for simplicity you can use memory cache), and return result to the user. Result should be returned as Status (whether bet was correct and accepted), Spin ID (automatically generated on the server side), Winning Number and Won Amount in cents. 

**Note:** for each bet, server side application should record user’s IP address and date & time when the bet was made. 

## Game History
Method to request game history for the user. Game history list returned to the client must contain the following information: Spin ID, Bet Amount, Won Amount and Date & Time (when the bet was made). 

## Sign-out method
Server side application must be able to track whether user is connected to the backend and if he/she is active. If user is not active for more then 5 minutes, he/she must be automatically signed out from the system. 

## Jackpot
Method for requesting current jackpot amount.  

Jackpot is calculated in the following manner: when user makes a bet, 1% from each of his/her bet will be added to the jackpot amount. When jackpot amount is changed it must be automatically pushed to all connected clients. 

## Notes
Communication protocol between client and server must be http/https protocol. (Also suggestions (with explanation) about other protocols, that can be compatible with client application written in Javascript, are more then welcome). 

As a memory storage use memory cache.

Data transfer footprint between server and client must be as small as possible 

Code must have comments  

## Appendix
Pre-generated bet strings for testing purpose: 

```json
[{"T": "v", "I": 10, "C": 1, "K": 1},{"T": "n", "I": 11, "C": 1, "K": 1},{"T": "n", "I": 8, "C": 1, "K": 1},{"T": "n", "I": 5, "C": 6, "K": 1},{"T": "n", "I": 19, "C": 1, "K": 1},{"T": "n", "I": 16, "C": 1, "K": 1},{"T": "n", "I": 14, "C": 1, "K": 1},{"T": "s", "I": 18, "C": 1, "K": 1}]
```

```json
[{"T": "v", "I": 17, "C": 1, "K": 1},{"T": "n", "I": 20, "C": 1, "K": 1},{"T": "n", "I": 23, "C": 1, "K": 1},{"T": "n", "I": 26, "C": 1, "K": 1}]
```

```json
[{"T": "n", "I": 17, "C": 1, "K": 1},{"T": "n", "I": 19, "C": 1, "K": 1},{"T": "n", "I": 22, "C": 1, "K": 1}]
```

```json
[{"T": "n", "I": 14, "C": 1, "K": 10},{"T": "n", "I": 17, "C": 1, "K": 10}]
```

```json
[{"T": "v", "I": 20, "C": 1, "K": 1}]
```

# About project
1) Create .net web api project, .net 6 and above.
3) There should be three controllers with all functionality.
4) The customer must connect to jackpot-hub in order to receive jackpot changes.
5) Because we are unable to calculate 10% of 1 cent otherwise, the jackpot amount is written in our format where 1 cent is 10_000.
